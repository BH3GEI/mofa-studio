# MoFA Studio - Pixi Configuration
# Simplified version with Python runtime (no Dora dataflow)
# Usage: pixi install && pixi run setup

[project]
name = "mofa-studio"
version = "0.1.0"
description = "MoFA Studio - Rust UI with Python backends (simplified, no Dora)"
channels = ["conda-forge"]
platforms = ["osx-arm64", "osx-64", "linux-64", "win-64"]

# =============================================================================
# CONDA DEPENDENCIES
# =============================================================================

[dependencies]
# Python runtime for backend services
python = "3.12.*"

# System libraries
portaudio = "*"
openssl = "*"
ffmpeg = "*"

# =============================================================================
# PYPI DEPENDENCIES (精简版)
# =============================================================================

[pypi-dependencies]
# HTTP client for API calls
requests = "*"
httpx = "*"

# Web framework for Python backends
fastapi = "*"
uvicorn = "*"

# Audio processing
pydub = "*"

# Data handling
numpy = "<2.0"
pandas = "*"

# Utilities
python-dotenv = "*"
pyyaml = "*"

# Optional: lightweight ASR (can be installed on demand)
# faster-whisper = "*"  # Commented out - install manually if needed

# =============================================================================
# ENVIRONMENTS
# =============================================================================

[environments]
default = { solve-group = "default" }

# =============================================================================
# TASKS
# =============================================================================

[tasks]
# Full setup
setup = { depends-on = ["build-rust"] }

# Build Rust only (no Dora nodes)
build-rust = "cargo build --release"

# Development
dev = "cargo run --release"
run = "cargo run --release"

# Clean
clean = "cargo clean"

# =============================================================================
# ACTIVATION
# =============================================================================

[activation]
scripts = ["scripts/activate.sh"]

[activation.env]
MOFA_STUDIO_ROOT = "$PIXI_PROJECT_ROOT"
